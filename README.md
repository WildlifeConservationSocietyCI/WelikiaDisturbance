# WelikiaDisturbance
Integrated fire and horticulture and pond disturbance model

## Requirements ##
 
#### Python 2.7 + arcpy
ESRI python distribution which contains arcpy library ([WCS license information](https://docs.google.com/document/d/1Mene0tUbbVP063KYKkhCV-sOWz3elkcMEq0bak3vxtE/edit#))

64-bit Background Geoprocessing Python 2.7.10 [MSC v.1500 64 bit (AMD64)]

#### Python Libraries

[numpy‑1.13.1+mkl‑cp27‑cp27m‑win_amd64](http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy)

[GDAL 2.0.2 x64 bindings](http://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal)

[pywin32-214.win-amd64-py3.0.exe](https://sourceforge.net/projects/pywin32/files/pywin32/Build%20214/)

pandas

scipy

WMI


#### FARSITE
[FARSITE 4.1.055](http://www.firelab.org/document/farsite-software)

#### Model Inputs

##### General
[Welikia full extent inputs](https://drive.google.com/open?id=0ByGEknMOH_xMQWhMR04wUEZ2bjQ)
This is the set of spatial data inputs required to run all modules of the disturbance model
  - DEM
  - Ecological communities
  - welikia region boundaries
  - Lenape trails
  - Lenape garden sites

- welikia_community_translation_table.csv

##### Tree Allometery
  - site_index_curve_table.csv
  - dbh_lookup.csv
  - basal_area_growth_coeffecients.csv

##### Fire
  **Tables**
  - custom_fuel.fmd <sup>[2](#myfootnote2)</sup>
  - fuel_adjustment.adj <sup>[2](#myfootnote2)</sup>
  - fuel_moisture.fms <sup>[2](#myfootnote2)</sup>
  - mannahatta-psdi.txt <sup>[2](#myfootnote2)</sup>
  - psdi-years.txt <sup>[2](#myfootnote2)</sup>
  - wtr record <sup>[2](#myfootnote2)</sup>
  - wind.wnd <sup>[2](#myfootnote2)</sup>
  
  **Spatial Data**
  - aspect.asc <sup>[1](#myfootnote1)</sup>
  - dem.asc <sup>[1](#myfootnote1)</sup>
  - slope.asc <sup>[1](#myfootnote1)</sup>
  - canopy.asc <sup>[1](#myfootnote1)</sup>
  - fuel.asc <sup>[1](#myfootnote1)</sup>
  - fire_trails.asc <sup>[1](#myfootnote1)</sup>
  - hunting_sites.asc <sup>[1](#myfootnote1)</sup>
  - PROJECT.FPJ <sup>[2](#myfootnote2)</sup>
  - LANDSCAPE.LCP <sup>[2](#myfootnote2)</sup>
  
##### Garden
  **Tables**
  - welikia_lc_reclass.txt <sup>[2](#myfootnote2)</sup>
  - proximity_reclass.txt <sup>[2](#myfootnote2)</sup>
  
  **Spatial Data**
  - garden_sites.shp <sup>[1](#myfootnote1)</sup>
  - proximity_suitability.tif <sup>[1](#myfootnote1)</sup>
  - slope_suitability.tif <sup>[1](#myfootnote1)</sup>
  
##### Pond  
  **Spatial Data**
  - dem.tif <sup>[1](#myfootnote1)</sup>
  - flow_direction.tif <sup>[1](#myfootnote1)</sup>
  - stream_suitability.tif <sup>[1](#myfootnote1)</sup>
  
<a name="myfootnote1">1</a>: inputs are generated by the script

<a name="myfootnote2">2</a>: inputs must be provided

## Disturbances Types

### Fire
This class uses [FARSITE](https://www.firelab.org/project/farsite) to simulate the historical burning regime. Fire spread is modeled by FARSITE and the outputs of burning events are used to calculate tree mortality and update forest age and canopy rasters. Changes to these rasters are then used to modify ecosystem types.

### Beaver Ponds
This class adds beaver disturbance to the landscape, including ponding and pond abandonment. Ponds are created by flooding the DEM at randomly selected dam points. Pond shape is determined by topography (flow direction -> watershed) and dam height (flooding depth). Location of ponds is random along the paths of mapped streams with slopes of eight degrees or less. Density is determined by a minimum territory distance parameter (1000 m).
 
### Horticulture
This class adds and abandons horticultural fields. The general placment of gardens is determined by the location of lenape sites (identified in the ethnohistorical, cartographic, archaeological records) which meet slope and distance to freshwater criteria. At the site scale gardens are positioned based on a horticultural suitability index(slope, ecosystem, proximity to habitation site).

### Ecological Succession
This class updates the growth of forest type communities (DBH, age, tree height) and transitions early succesional communities to advanced states using pathways defined in welikia_community_table_int.csv

## Module Integration 
![alt text](https://github.com/WildlifeConservationSocietyCI/WelikiaDisturbance/blob/master/disturbance_model_notes/figures/succession_disturbance_diagram.png "Logo Title Text 1")

## Setup
 1. clone WelikiaDistrubance repository 
 2. download welikia_full_extent_inputs move to WelikiaDisturbance directory
 3. Set project and log paths in configuration local_settings.py
 4. Run dir_setup.py
 5. Run initiate_disturbance_inputs.py
 6. Create FARSITE PROJECT and LANDSCAPE files manually in FARSITE GUI
 7. Configure settings in scenario_settings.py
 8. Run disturbance_script.py
 
#TODO
- copy files from fire tabular inputs to region spatial directory with FARSITE project
- move all tabular inputs to tables dir in model sub-dirs 
